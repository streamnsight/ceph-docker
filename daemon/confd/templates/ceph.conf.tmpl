# Created and Maintained by Confd

[global]
{{ range $i, $k := ls "/auth" }}
    {{ if not $i }}
      {{ if exists "/auth/fsid" }}
fsid = {{getv "/auth/fsid"}}
        {{ end }}
    {{ end }}
{{ end }}

{{ range $i, $k := ls "/auth" }}
    {{ if not $i }}
      {{ if exists "/auth/cephx"}}
auth_cluster_required = cephx
auth_service_required = cephx
auth_client_required = cephx
        {{if exists "/auth/cephx_require_signatures"}}
cephx_require_signatures = {{getv "/auth/cephx_require_signatures"}} # Kernel RBD does NOT support signatures!
        {{else}}
cephx_require_signatures = false
        {{end}}
        {{if exists "/auth/cephx_cluster_require_signatures"}}
cephx_cluster_require_signatures = {{getv "/auth/cephx_cluster_require_signatures"}}
        {{else}}
cephx_cluster_require_signatures = true
        {{end}}
        {{if exists "/auth/cephx_service_require_signatures"}}
cephx_service_require_signatures = {{getv "/auth/cephx_service_require_signatures"}}
        {{else}}
cephx_service_require_signatures = false
        {{end}}
      {{else}}
auth cluster required = none
auth service required = none
auth client required = none
auth supported = none
      {{end}}
    {{ end }}
{{ end }}

{{ range $i, $k := ls "/global" }}
    {{ if not $i }}
      {{range gets "/global/*"}}
{{base .Key}} = {{.Value}}{{end}}
    {{ end }}
{{ end }}

[mon]
{{ range $i, $k := ls "/mon" }}
    {{ if not $i }}
      {{range gets "/mon/*"}}
{{base .Key}} = {{.Value}}{{end}}
    {{ end }}
{{ end }}
{{ range $i, $k := ls "/mon_host" }}
    {{ if not $i }}
      {{range gets "/mon_host/*"}}
[mon.{{base .Key}}]
host = {{base .Key}}
mon_addr = {{.Value}}{{end}}
    {{ end }}
{{ end }}

[osd]
{{ range $i, $k := ls "/osd" }}
    {{ if not $i }}
      {{range gets "/osd/*"}}
{{base .Key}} = {{.Value}}{{end}}
    {{ end }}
{{ end }}

[mds]
{{ range $i, $k := ls "/mds" }}
    {{ if not $i }}
      {{range gets "/mds/*"}}
{{base .Key}} = {{.Value}}{{end}}
    {{ end }}
{{ end }}

[client]
{{ range $i, $k := ls "/client" }}
    {{ if not $i }}
      {{range gets "/client/*"}}
{{base .Key}} = {{.Value}}{{end}}
    {{ end }}
{{ end }}
